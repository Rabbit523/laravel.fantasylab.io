!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.ReeValidate={})}(this,function(t){"use strict";var e=function(t){return null==t},i=function(t,e,i){if(void 0===i&&(i=void 0),!t||!e)return i;var n=e;return t.split(".").every(function(t){return Object.prototype.hasOwnProperty.call(n,t)||void 0!==n[t]?(n=n[t],!0):(n=i,!1)}),n},n=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=!1),0===e?t:function(){for(var r=[],s=arguments.length;s--;)r[s]=arguments[s];var a=i&&!n;clearTimeout(n),n=setTimeout(function(){n=null,i||t.apply(void 0,r)},e),a&&t.apply(void 0,r)};var n},r=function(t){console.warn("[ree-validate] "+t)},s=function(t){return new Error("[ree-validate] "+t)},a=function(t){return null!==t&&t&&"object"==typeof t&&!Array.isArray(t)},o=function(t){return"function"==typeof t},u=function(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))},l=function(t,e,i){var n,r;if(t&&e){if(!Array.isArray(e))return i?(r=e,void((n=t).classList?n.classList.add(r):u(n,r)||(n.className+=" "+r))):void function(t,e){if(t.classList)t.classList.remove(e);else if(u(t,e)){var i=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(i," ")}}(t,e);e.forEach(function(e){return l(t,e,i)})}},c=function(t){if(o(Array.from))return Array.from(t);for(var e=[],i=t.length,n=0;n<i;n++)e.push(t[n]);return e},d=function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];if(o(Object.assign))return Object.assign.apply(Object,[t].concat(e));if(null==t)throw new TypeError("Cannot convert undefined or null to object");var n=Object(t);return e.forEach(function(t){null!=t&&Object.keys(t).forEach(function(e){n[e]=t[e]})}),n},h=0,f="{id}",p=function(t,e){for(var i=Array.isArray(t)?t:c(t),n=0;n<i.length;n++)if(e(i[n]))return i[n]},v=function(t){return t&&("SELECT"===t.tagName||~["radio","checkbox","file"].indexOf(t.type))?"change":"input"},m=function(t,e,i){return"number"==typeof e?t.reduce(function(t,i){return t[i]=e,t},{}):t.reduce(function(t,n){return"object"==typeof e&&n in e?(t[n]=e[n],t):"number"==typeof i?(t[n]=i,t):(t[n]=i&&i[n]||0,t)},{})},g=function(t,e){return a(t)&&a(e)?(Object.keys(e).forEach(function(i){var n,r;if(a(e[i]))return t[i]||d(t,((n={})[i]={},n)),void g(t[i],e[i]);d(t,((r={})[i]=e[i],r))}),t):t},y=function(){this.items=[]};y.prototype.add=function(t){arguments.length>1&&(t={field:arguments[0],msg:arguments[1],rule:arguments[2],scope:e(arguments[3])?null:arguments[3],regenerate:null}),t.scope=e(t.scope)?null:t.scope,this.items.push(t)},y.prototype.regenerate=function(){this.items.forEach(function(t){t.msg=o(t.regenerate)?t.regenerate():t.msg})},y.prototype.update=function(t,e){var i=p(this.items,function(e){return e.id===t});if(i){var n=this.items.indexOf(i);this.items.splice(n,1),i.scope=e.scope,this.items.push(i)}},y.prototype.all=function(t){return e(t)?this.items.map(function(t){return t.msg}):this.items.filter(function(e){return e.scope===t}).map(function(t){return t.msg})},y.prototype.any=function(t){return e(t)?!!this.items.length:!!this.items.filter(function(e){return e.scope===t}).length},y.prototype.clear=function(t){e(t)&&(t=null);for(var i=0;i<this.items.length;++i)this.items[i].scope===t&&(this.items.splice(i,1),--i)},y.prototype.collect=function(t,i,n){if(void 0===n&&(n=!0),!t){var r={};return this.items.forEach(function(t){r[t.field]||(r[t.field]=[]),r[t.field].push(n?t.msg:t)}),r}return t=e(t)?t:String(t),e(i)?this.items.filter(function(e){return e.field===t}).map(function(t){return n?t.msg:t}):this.items.filter(function(e){return e.field===t&&e.scope===i}).map(function(t){return n?t.msg:t})},y.prototype.count=function(){return this.items.length},y.prototype.firstById=function(t){var e=p(this.items,function(e){return e.id===t});return e?e.msg:null},y.prototype.first=function(t,i){if(void 0===i&&(i=null),e(t))return null;t=String(t);var n=this._selector(t),r=this._scope(t);if(r){var s=this.first(r.name,r.scope);if(s)return s}if(n)return this.firstByRule(n.name,n.rule,i);for(var a=0;a<this.items.length;++a)if(this.items[a].field===t&&this.items[a].scope===i)return this.items[a].msg;return null},y.prototype.firstRule=function(t,e){var i=this.collect(t,e,!1);return i.length&&i[0].rule||null},y.prototype.has=function(t,e){return void 0===e&&(e=null),!!this.first(t,e)},y.prototype.firstByRule=function(t,e,i){void 0===i&&(i=null);var n=this.collect(t,i,!1).filter(function(t){return t.rule===e})[0];return n&&n.msg||null},y.prototype.firstNot=function(t,e,i){void 0===e&&(e="required"),void 0===i&&(i=null);var n=this.collect(t,i,!1).filter(function(t){return t.rule!==e})[0];return n&&n.msg||null},y.prototype.removeById=function(t){for(var e=0;e<this.items.length;++e)this.items[e].id===t&&(this.items.splice(e,1),--e)},y.prototype.remove=function(t,i,n){t=e(t)?t:String(t);for(var r,s=0;s<this.items.length;++s)((r=this.items[s]).id&&n?r.id===n:e(i)?r.field===t&&null===r.scope:r.field===t&&r.scope===i)&&(this.items.splice(s,1),--s)},y.prototype._selector=function(t){if(t.indexOf(":")>-1){var e=t.split(":");return{name:e[0],rule:e[1]}}return null},y.prototype._scope=function(t){if(t.indexOf(".")>-1){var e=t.split("."),i=e[0];return{name:e.slice(1).join("."),scope:i}}return null};var b={targetOf:null,initial:!1,scope:null,listen:!0,name:null,rules:{},vm:null,classes:!1,validity:!0,aria:!0,events:"input|blur",delay:0,classNames:{touched:"touched",untouched:"untouched",valid:"valid",invalid:"invalid",pristine:"pristine",dirty:"dirty"}},_=function(t,n){void 0===n&&(n={}),this.id=(h>=9999&&(h=0,f=f.replace("{id}","_{id}")),h++,f.replace("{id}",String(h))),this.el=t,this.updated=!1,this.dependencies=[],this.watchers=[],this.events=[],this.delay=0,this.rules={},this._cacheId(n),this.classNames=d({},b.classNames),n=d({},b,n),this._delay=e(n.delay)?0:n.delay,this.validity=n.validity,this.aria=n.aria,this.flags={untouched:!0,touched:!1,dirty:!1,pristine:!0,valid:null,invalid:null,validated:!1,pending:!1,required:!1},this.vm=n.vm,this.component=n.component,this.ctorConfig=this.component?i("$options.$_reeValidate",this.component):void 0,this.update(n),this.updated=!1},w={validator:{configurable:!0},isRequired:{configurable:!0},isDisabled:{configurable:!0},alias:{configurable:!0},value:{configurable:!0},rejectsFalse:{configurable:!0}};w.validator.get=function(){return this.vm&&this.vm.$validator?this.vm.$validator:(r("No validator instance detected."),{validate:function(){}})},w.isRequired.get=function(){return!!this.rules.required},w.isDisabled.get=function(){return!(!this.component||!this.component.disabled)||!(!this.el||!this.el.disabled)},w.alias.get=function(){if(this._alias)return this._alias;var t,e,i=null;return this.el&&(t=this.el,e="as",i=t.getAttribute("data-vv-"+e)),!i&&this.component?this.component.$attrs&&this.component.$attrs["data-vv-as"]:i},w.value.get=function(){if(o(this.getter))return this.getter()},w.rejectsFalse.get=function(){return this.component&&this.ctorConfig?!!this.ctorConfig.rejectsFalse:!!this.el&&"checkbox"===this.el.type},_.prototype.matches=function(t){return t.id?this.id===t.id:void 0===t.name&&void 0===t.scope||(void 0===t.scope?this.name===t.name:void 0===t.name?this.scope===t.scope:t.name===this.name&&t.scope===this.scope)},_.prototype._cacheId=function(t){var e,i,n;this.el&&!t.targetOf&&(e=this.el,i="id",n=this.id,e.setAttribute("data-vv-"+i,n))},_.prototype.update=function(t){var i,n;this.targetOf=t.targetOf||null,this.initial=t.initial||this.initial||!1,!e(t.scope)&&t.scope!==this.scope&&o(this.validator.update)&&this.validator.update(this.id,{scope:t.scope}),this.scope=e(t.scope)?e(this.scope)?null:this.scope:t.scope,this.name=(e(t.name)?t.name:String(t.name))||this.name||null,this.rules=void 0!==t.rules?(i=t.rules)?a(i)?Object.keys(i).reduce(function(t,e){var n=[];return n=!0===i[e]?[]:Array.isArray(i[e])?i[e]:[i[e]],!1!==i[e]&&(t[e]=n),t},{}):"string"!=typeof i?(r("rules must be either a string or an object."),{}):i.split("|").reduce(function(t,e){var i,n,r,s=(n=[],r=(i=e).split(":")[0],~i.indexOf(":")&&(n=i.split(":").slice(1).join(":").split(",")),{name:r,params:n});return s.name?(t[s.name]=s.params,t):t},{}):{}:this.rules,this.model=t.model||this.model,this.listen=void 0!==t.listen?t.listen:this.listen,this.classes=!(!t.classes&&!this.classes)&&!this.component,this.classNames=a(t.classNames)?g(this.classNames,t.classNames):this.classNames,this.getter=o(t.getter)?t.getter:this.getter,this._alias=t.alias||this._alias,this.events=t.events?"string"==typeof(n=t.events)&&n.length?n.split("|"):[]:this.events,this.delay=t.delay?m(this.events,t.delay,this._delay):m(this.events,this.delay,this._delay),this.updateDependencies(),this.addActionListeners(),void 0!==t.rules&&(this.flags.required=this.isRequired),this.flags.validated&&void 0!==t.rules&&this.updated&&this.validator.validate("#"+this.id),this.updated=!0,this.addValueListeners(),this.el&&(this.updateClasses(),this.updateAriaAttrs())},_.prototype.reset=function(){var t=this,e={untouched:!0,touched:!1,dirty:!1,pristine:!0,valid:null,invalid:null,validated:!1,pending:!1,required:!1};Object.keys(this.flags).filter(function(t){return"required"!==t}).forEach(function(i){t.flags[i]=e[i]}),this.addActionListeners(),this.updateClasses(),this.updateAriaAttrs(),this.updateCustomValidity()},_.prototype.setFlags=function(t){var e=this,i={pristine:"dirty",dirty:"pristine",valid:"invalid",invalid:"valid",touched:"untouched",untouched:"touched"};Object.keys(t).forEach(function(n){e.flags[n]=t[n],i[n]&&void 0===t[i[n]]&&(e.flags[i[n]]=!t[n])}),void 0===t.untouched&&void 0===t.touched&&void 0===t.dirty&&void 0===t.pristine||this.addActionListeners(),this.updateClasses(),this.updateAriaAttrs(),this.updateCustomValidity()},_.prototype.updateDependencies=function(){var t=this;this.dependencies.forEach(function(t){return t.field.destroy()}),this.dependencies=[];var e=Object.keys(this.rules).reduce(function(e,i){if(V.isTargetRule(i)){var n=t.rules[i][0];"confirmed"!==i||n||(n=t.name+"_confirmation"),e.push({selector:n,name:i})}return e},[]);e.length&&this.vm&&this.vm.$el&&e.forEach(function(e){var i=e.selector,n=e.name,r=null;if("$"===i[0]){var s=t.vm.$refs[i.slice(1)];r=Array.isArray(s)?s[0]:s}else try{r=t.vm.$el.querySelector(i)}catch(t){r=null}if(!r)try{r=t.vm.$el.querySelector('input[name="'+i+'"]')}catch(t){r=null}if(r){var a={vm:t.vm,classes:t.classes,classNames:t.classNames,delay:t.delay,scope:t.scope,events:t.events.join("|"),initial:t.initial,targetOf:t.id};t.dependencies.push({name:n,field:new _(a.el,a)})}})},_.prototype.unwatch=function(t){if(void 0===t&&(t=null),!t)return this.watchers.forEach(function(t){return t.unwatch()}),void(this.watchers=[]);this.watchers.filter(function(e){return t.test(e.tag)}).forEach(function(t){return t.unwatch()}),this.watchers=this.watchers.filter(function(e){return!t.test(e.tag)})},_.prototype.updateClasses=function(){this.classes&&!this.isDisabled&&(l(this.el,this.classNames.dirty,this.flags.dirty),l(this.el,this.classNames.pristine,this.flags.pristine),l(this.el,this.classNames.touched,this.flags.touched),l(this.el,this.classNames.untouched,this.flags.untouched),!e(this.flags.valid)&&this.flags.validated&&l(this.el,this.classNames.valid,this.flags.valid),!e(this.flags.invalid)&&this.flags.validated&&l(this.el,this.classNames.invalid,this.flags.invalid))},_.prototype.addActionListeners=function(){var t=this;this.unwatch(/class/);var e=function(){t.flags.touched=!0,t.flags.untouched=!1,t.classes&&(l(t.el,t.classNames.touched,!0),l(t.el,t.classNames.untouched,!1)),t.unwatch(/^class_blur$/)},i=v(this.el),n=function(){t.flags.dirty=!0,t.flags.pristine=!1,t.classes&&(l(t.el,t.classNames.pristine,!1),l(t.el,t.classNames.dirty,!0)),t.unwatch(/^class_input$/)};if(this.component&&o(this.component.$once))return this.component.$once("input",n),this.component.$once("blur",e),this.watchers.push({tag:"class_input",unwatch:function(){t.component.$off("input",n)}}),void this.watchers.push({tag:"class_blur",unwatch:function(){t.component.$off("blur",e)}});if(this.el){this.el.addEventListener(i,n);var r=-1===["radio","checkbox"].indexOf(this.el.type)?"blur":"click";this.el.addEventListener(r,e),this.watchers.push({tag:"class_input",unwatch:function(){t.el.removeEventListener(i,n)}}),this.watchers.push({tag:"class_blur",unwatch:function(){t.el.removeEventListener(r,e)}})}},_.prototype.addValueListeners=function(){var t=this;if(this.unwatch(/^input_.+/),this.listen){var e=this.targetOf?function(){t.validator.validate("#"+t.targetOf)}:function(){for(var e=[],i=arguments.length;i--;)e[i]=arguments[i];(0===e.length||o(Event)&&e[0]instanceof Event||e[0]&&e[0].srcElement)&&(e[0]=t.value),t.validator.validate("#"+t.id,e[0])},i=this.model&&this.model.lazy?"change":v(this.el),r=this.events.map(function(t){return"input"===t?i:t});if(this.model&&this.model.expression&&-1!==r.indexOf(i)){var s=n(e,this.delay[i]),a=this.vm.$watch(this.model.expression,function(){for(var e=[],i=arguments.length;i--;)e[i]=arguments[i];t.flags.pending=!0,s.apply(void 0,e)});this.watchers.push({tag:"input_model",unwatch:a}),r=r.filter(function(t){return t!==i})}r.forEach(function(i){var r=n(e,t.delay[i]),s=function(){for(var e=[],i=arguments.length;i--;)e[i]=arguments[i];t.flags.pending=!0,r.apply(void 0,e)};t._addComponentEventListener(i,s),t._addHTMLEventListener(i,s)})}},_.prototype._addComponentEventListener=function(t,e){var i=this;this.component&&(this.component.$on(t,e),this.watchers.push({tag:"input_vue",unwatch:function(){i.component.$off(t,e)}}))},_.prototype._addHTMLEventListener=function(t,e){var i=this;if(this.el)if(~["radio","checkbox"].indexOf(this.el.type)){var n=document.querySelectorAll('input[name="'+this.el.name+'"]');c(n).forEach(function(n){n.addEventListener(t,e),i.watchers.push({tag:"input_native",unwatch:function(){n.removeEventListener(t,e)}})})}else this.el.addEventListener(t,e),this.watchers.push({tag:"input_native",unwatch:function(){i.el.removeEventListener(t,e)}})},_.prototype.updateAriaAttrs=function(){this.aria&&this.el&&o(this.el.setAttribute)&&(this.el.setAttribute("aria-required",this.isRequired?"true":"false"),this.el.setAttribute("aria-invalid",this.flags.invalid?"true":"false"))},_.prototype.updateCustomValidity=function(){this.validity&&this.el&&o(this.el.setCustomValidity)&&this.el.setCustomValidity(this.flags.valid?"":this.validator.errors.firstById(this.id)||"")},_.prototype.destroy=function(){this.unwatch(),this.dependencies.forEach(function(t){return t.field.destroy()}),this.dependencies=[]},Object.defineProperties(_.prototype,w);var E=function(){this.items=[]},A={length:{configurable:!0}};A.length.get=function(){return this.items.length},E.prototype.find=function(t){return p(this.items,function(e){return e.matches(t)})},E.prototype.filter=function(t){return Array.isArray(t)?this.items.filter(function(e){return t.some(function(t){return e.matches(t)})}):this.items.filter(function(e){return e.matches(t)})},E.prototype.map=function(t){return this.items.map(t)},E.prototype.remove=function(t){var e=null;if(!(e=t instanceof _?t:this.find(t)))return null;var i=this.items.indexOf(e);return this.items.splice(i,1),e},E.prototype.push=function(t){if(!(t instanceof _))throw s("FieldBag only accepts instances of Field that has an id defined.");if(!t.id)throw s("Field id must be defined.");if(this.find({id:t.id}))throw s("Field with id "+t.id+" is already added.");this.items.push(t)},Object.defineProperties(E.prototype,A);var O="en",F=function(t){void 0===t&&(t={}),this.container={},this.merge(t)},x={locale:{configurable:!0}};x.locale.get=function(){return O},x.locale.set=function(t){O=t||"en"},F.prototype.hasLocale=function(t){return!!this.container[t]},F.prototype.setDateFormat=function(t,e){this.container[t]||(this.container[t]={}),this.container[t].dateFormat=e},F.prototype.getDateFormat=function(t){return this.container[t]&&this.container[t].dateFormat?this.container[t].dateFormat:null},F.prototype.getMessage=function(t,e,i){var n=null;return n=this.hasMessage(t,e)?this.container[t].messages[e]:this._getDefaultMessage(t),o(n)?n.apply(void 0,i):n},F.prototype.getFieldMessage=function(t,e,i,n){if(!this.hasLocale(t))return this.getMessage(t,i,n);var r=this.container[t].custom&&this.container[t].custom[e];if(!r||!r[i])return this.getMessage(t,i,n);var s=r[i];return o(s)?s.apply(void 0,n):s},F.prototype._getDefaultMessage=function(t){return this.hasMessage(t,"_default")?this.container[t].messages._default:this.container.en.messages._default},F.prototype.getAttribute=function(t,e,i){return void 0===i&&(i=""),this.hasAttribute(t,e)?this.container[t].attributes[e]:i},F.prototype.hasMessage=function(t,e){return!!(this.hasLocale(t)&&this.container[t].messages&&this.container[t].messages[e])},F.prototype.hasAttribute=function(t,e){return!!(this.hasLocale(t)&&this.container[t].attributes&&this.container[t].attributes[e])},F.prototype.merge=function(t){g(this.container,t)},F.prototype.setMessage=function(t,e,i){this.hasLocale(t)||(this.container[t]={messages:{},attributes:{}}),this.container[t].messages[e]=i},F.prototype.setAttribute=function(t,e,i){this.hasLocale(t)||(this.container[t]={messages:{},attributes:{}}),this.container[t].attributes[e]=i},Object.defineProperties(F.prototype,x);var $=function(t){return a(t)?Object.keys(t).reduce(function(e,i){return e[i]=$(t[i]),e},{}):o(t)?t("{0}",["{1}","{2}","{3}"]):t},j=function(t,e){this.i18n=t,this.rootKey=e},L={locale:{configurable:!0}};L.locale.get=function(){return this.i18n.locale},L.locale.set=function(t){r("Cannot set locale from the validator when using vue-i18n, use i18n.locale setter instead")},j.prototype.getDateFormat=function(t){return this.i18n.getDateTimeFormat(t||this.locale)},j.prototype.setDateFormat=function(t,e){this.i18n.setDateTimeFormat(t||this.locale,e)},j.prototype.getMessage=function(t,e,i){var n=this.rootKey+".messages."+e;return this.i18n.te(n)?this.i18n.t(n,t,i):this.i18n.t(this.rootKey+".messages._default",t,i)},j.prototype.getAttribute=function(t,e,i){void 0===i&&(i="");var n=this.rootKey+".attributes."+e;return this.i18n.te(n)?this.i18n.t(n,t):i},j.prototype.getFieldMessage=function(t,e,i,n){var r=this.rootKey+".custom."+e+"."+i;return this.i18n.te(r)?this.i18n.t(r):this.getMessage(t,i,n)},j.prototype.merge=function(t){var e=this;Object.keys(t).forEach(function(n){var r,s,a=g({},i(n+"."+e.rootKey,e.i18n.messages,{})),o=g(a,(s=t[n],{messages:$(s.messages),custom:$(s.custom),attributes:s.attributes,dateFormat:s.dateFormat}));e.i18n.mergeLocaleMessage(n,((r={})[e.rootKey]=o,r)),o.dateFormat&&e.i18n.setDateTimeFormat(n,o.dateFormat)})},j.prototype.setMessage=function(t,e,i){var n,r;this.merge(((r={})[t]={messages:(n={},n[e]=i,n)},r))},j.prototype.setAttribute=function(t,e,i){var n,r;this.merge(((r={})[t]={attributes:(n={},n[e]=i,n)},r))},Object.defineProperties(j.prototype,L);var N={locale:"en",delay:0,errorBagName:"errors",dictionary:null,strict:!0,fieldsBagName:"fields",classes:!1,classNames:null,events:"input|blur",inject:!0,fastExit:!0,aria:!0,validity:!1,i18n:null,i18nRootKey:"validation"},M=d({},N),P={dictionary:new F({en:{messages:{},attributes:{},custom:{}}})},k=function(){},D={default:{configurable:!0},current:{configurable:!0}};D.default.get=function(){return N},D.current.get=function(){return M},k.dependency=function(t){return P[t]},k.merge=function(t){(M=d({},M,t)).i18n&&k.register("dictionary",new j(M.i18n,M.i18nRootKey))},k.register=function(t,e){P[t]=e},k.resolve=function(t){var e=i("$options.$_reeValidate",t,{});return d({},k.current,e)},Object.defineProperties(k,D);var T={},R=!0,q=["confirmed","after","before"],C=[],V=function(t,e){var i=this;void 0===e&&(e={vm:null,fastExit:!0}),this.strict=R,this.errors=new y,"undefined"!=typeof window&&C.push(this.errors),this.fields=new E,this.flags={},this._createFields(t),this.paused=!1,this.fastExit=e.fastExit||!1,this.ownerId=e.vm&&e.vm._uid,this.reset=e.vm&&o(e.vm.$nextTick)?function(t){return new Promise(function(n){e.vm.$nextTick(function(){e.vm.$nextTick(function(){n(i._reset(t))})})})}:this._reset},S={dictionary:{configurable:!0},locale:{configurable:!0},rules:{configurable:!0}},B={dictionary:{configurable:!0},locale:{configurable:!0},rules:{configurable:!0}};S.dictionary.get=function(){return k.dependency("dictionary")},B.dictionary.get=function(){return k.dependency("dictionary")},S.locale.get=function(){return this.dictionary.locale},S.locale.set=function(t){V.locale=t},B.locale.get=function(){return V.dictionary.locale},B.locale.set=function(t){var e=t!==V.dictionary.locale;V.dictionary.locale=t,e&&V.regenerate()},S.rules.get=function(){return T},B.rules.get=function(){return T},V.create=function(t,e){return new V(t,e)},V.extend=function(t,e,i){void 0===i&&(i={}),V._guardExtend(t,e),V._merge(t,e),i&&i.hasTarget&&q.push(t)},V.regenerate=function(){C.forEach(function(t){return t.regenerate()})},V.remove=function(t){delete T[t];var e=q.indexOf(t);-1!==e&&q.splice(e,1)},V.isTargetRule=function(t){return-1!==q.indexOf(t)},V.setStrictMode=function(t){void 0===t&&(t=!0),R=t},V.prototype.localize=function(t,e){V.localize(t,e)},V.localize=function(t,e){var i;if(a(t))V.dictionary.merge(t);else{if(e){var n=t||e.name;e=d({},e),V.dictionary.merge(((i={})[n]=e,i))}t&&(V.locale=t)}},V.prototype.attach=function(t){arguments.length>1&&(r("This signature of the attach method has been deprecated, please consult the docs."),t=d({},{name:arguments[0],rules:arguments[1]},arguments[2]||{vm:{$validator:this}}));var e=t.initialValue;return t instanceof _||(t=new _(t.el||null,t)),this.fields.push(t),t.initial?this.validate("#"+t.id,e||t.value):this._validate(t,e||t.value,!0).then(function(e){t.flags.valid=e.valid,t.flags.invalid=!e.valid}),this._addFlag(t,t.scope),t},V.prototype.flag=function(t,e){var i=this._resolveField(t);i&&e&&i.setFlags(e)},V.prototype.detach=function(t,i){var n=t instanceof _?t:this._resolveField(t,i);if(n){n.destroy(),this.errors.remove(n.name,n.scope,n.id),this.fields.remove(n);var r=this.flags;!e(n.scope)&&r["$"+n.scope]?delete r["$"+n.scope][n.name]:e(n.scope)&&delete r[n.name],this.flags=d({},r)}},V.prototype.extend=function(t,e,i){void 0===i&&(i={}),V.extend(t,e,i)},V.prototype.update=function(t,i){var n=i.scope,r=this._resolveField("#"+t);r&&(this.errors.update(t,{scope:n}),!e(r.scope)&&this.flags["$"+r.scope]?delete this.flags["$"+r.scope][r.name]:e(r.scope)&&delete this.flags[r.name],this._addFlag(r,n))},V.prototype.remove=function(t){V.remove(t)},V.prototype.validate=function(t,e,i){var n=this;if(void 0===i&&(i=null),this.paused)return Promise.resolve(!0);if(0===arguments.length)return this.validateScopes();if(1===arguments.length&&"*"===arguments[0])return this.validateAll();if(1===arguments.length&&"string"==typeof arguments[0]&&/^(.+)\.\*$/.test(arguments[0])){var r=arguments[0].match(/^(.+)\.\*$/)[1];return this.validateAll(r)}var s=this._resolveField(t,i);if(!s)return this._handleFieldNotFound(t,i);s.flags.pending=!0,1===arguments.length&&(e=s.value);var a=s.isDisabled;return this._validate(s,e,a).then(function(t){return n.errors.remove(s.name,s.scope,s.id),a?Promise.resolve(!0):(t.errors&&t.errors.forEach(function(t){return n.errors.add(t)}),s.setFlags({pending:!1,valid:t.valid,validated:!0}),t.valid)})},V.prototype.pause=function(){return this.paused=!0,this},V.prototype.resume=function(){return this.paused=!1,this},V.prototype.validateAll=function(t){var e=arguments,i=this;if(this.paused)return Promise.resolve(!0);var n=null,r=!1;"string"==typeof t?n={scope:t}:a(t)?(n=Object.keys(t).map(function(t){return{name:t,scope:e[1]||null}}),r=!0):0===arguments.length?n={scope:null}:Array.isArray(t)&&(n=t.map(function(t){return{name:t,scope:e[1]||null}}));var s=this.fields.filter(n).map(function(e){return i.validate("#"+e.id,r?t[e.name]:e.value)});return Promise.all(s).then(function(t){return t.every(function(t){return t})})},V.prototype.validateScopes=function(){var t=this;if(this.paused)return Promise.resolve(!0);var e=this.fields.map(function(e){return t.validate("#"+e.id,e.value)});return Promise.all(e).then(function(t){return t.every(function(t){return t})})},V.prototype.destroy=function(){var t=C.indexOf(this.errors);-1!==t&&C.splice(t,1)},V.prototype._createFields=function(t){var e=this;t&&Object.keys(t).forEach(function(i){var n=d({},{name:i,rules:t[i]});e.attach(n)})},V.prototype._getDateFormat=function(t){var e=null;return t.date_format&&Array.isArray(t.date_format)&&(e=t.date_format[0]),e||this.dictionary.getDateFormat(this.locale)},V.prototype._isADateRule=function(t){return!!~["after","before","date_between","date_format"].indexOf(t)},V.prototype._formatErrorMessage=function(t,e,i,n){void 0===i&&(i={}),void 0===n&&(n=null);var r=this._getFieldDisplayName(t),s=this._getLocalizedParams(e,n);return this.dictionary.getFieldMessage(this.locale,t.name,e.name,[r,s,i])},V.prototype._getLocalizedParams=function(t,e){return void 0===e&&(e=null),~q.indexOf(t.name)&&t.params&&t.params[0]?[e||this.dictionary.getAttribute(this.locale,t.params[0],t.params[0])].concat(t.params.slice(1)):t.params},V.prototype._getFieldDisplayName=function(t){return t.alias||this.dictionary.getAttribute(this.locale,t.name,t.name)},V.prototype._addFlag=function(t,i){var n,r,s;if(void 0===i&&(i=null),e(i))this.flags=d({},this.flags,((n={})[""+t.name]=t.flags,n));else{var a=d({},this.flags["$"+i]||{},((r={})[""+t.name]=t.flags,r));this.flags=d({},this.flags,((s={})["$"+i]=a,s))}},V.prototype._reset=function(t){var e=this;return new Promise(function(i){if(t)return e.fields.filter(t).forEach(function(t){t.reset(),e.errors.remove(t.name,t.scope,t.id)}),i();e.fields.items.forEach(function(t){return t.reset()}),e.errors.clear(),i()})},V.prototype._test=function(t,e,i){var n=this,r=T[i.name],u=Array.isArray(i.params)?c(i.params):[],l=null;if(!r||"function"!=typeof r)throw s("No such validator '"+i.name+"' exists.");if(-1!==q.indexOf(i.name)){var d=p(t.dependencies,function(t){return t.name===i.name});d&&(l=d.field.alias,u=[d.field.value].concat(u.slice(1)))}else"required"===i.name&&t.rejectsFalse&&(u=u.length?u:[!0]);if(this._isADateRule(i.name)){var h=this._getDateFormat(t.rules);"date_format"!==i.name&&u.push(h)}var f=r(e,u);return o(f.then)?f.then(function(e){var r=!0,s={};return Array.isArray(e)?r=e.every(function(t){return a(t)?t.valid:t}):(r=a(e)?e.valid:e,s=e.data),{valid:r,error:r?void 0:n._createFieldError(t,i,s,l)}}):(a(f)||(f={valid:f,data:{}}),{valid:f.valid,error:f.valid?void 0:this._createFieldError(t,i,f.data,l)})},V._merge=function(t,e){o(e)?T[t]=e:(T[t]=e.validate,e.getMessage&&V.dictionary.setMessage(this.locale,t,e.getMessage))},V._guardExtend=function(t,e){if(!o(e)){if(!o(e.validate))throw s("Extension Error: The validator '"+t+"' must be a function or have a 'validate' method.");if(!o(e.getMessage)&&"string"!=typeof e.getMessage)throw s("Extension Error: The validator '"+t+"' object must have a 'getMessage' method or string.")}},V.prototype._createFieldError=function(t,e,i,n){var r=this;return{id:t.id,field:t.name,msg:this._formatErrorMessage(t,e,i,n),rule:e.name,scope:t.scope,regenerate:function(){return r._formatErrorMessage(t,e,i,n)}}},V.prototype._resolveField=function(t,i){if(!e(i))return this.fields.find({name:t,scope:i});if("#"===t[0])return this.fields.find({id:t.slice(1)});if(t.indexOf(".")>-1){var n=t.split("."),r=n[0],s=n.slice(1),a=this.fields.find({name:s.join("."),scope:r});if(a)return a}return this.fields.find({name:t,scope:null})},V.prototype._handleFieldNotFound=function(t,i){if(!this.strict)return Promise.resolve(!0);var n=e(i)?t:(e(i)?"":i+".")+t;throw s('Validating a non-existent field: "'+n+'". Use "attach()" first.')},V.prototype._validate=function(t,i,n){var r=this;if(void 0===n&&(n=!1),!t.isRequired&&(e(i)||""===i))return Promise.resolve({valid:!0});var s=[],a=[],u=!1;return Object.keys(t.rules).some(function(e){var n=r._test(t,i,{name:e,params:t.rules[e]});return o(n.then)?s.push(n):r.fastExit&&!n.valid?(a.push(n.error),u=!0):s.push(new Promise(function(t){t(n)})),u}),u?Promise.resolve({valid:!1,errors:a}):Promise.all(s).then(function(t){return t.map(function(t){return t.valid||a.push(t.error),t.valid}).every(function(t){return t})}).then(function(t){return{valid:t,errors:a}})},Object.defineProperties(V.prototype,S),Object.defineProperties(V,B);var K=function(t,e){var i={pristine:function(t,e){return t&&e},dirty:function(t,e){return t||e},touched:function(t,e){return t||e},untouched:function(t,e){return t&&e},valid:function(t,e){return t&&e},invalid:function(t,e){return t||e},pending:function(t,e){return t||e},required:function(t,e){return t||e},validated:function(t,e){return t&&e}};return Object.keys(i).reduce(function(n,r){return n[r]=i[r](t[r],e[r]),n},{})},z=function(t,e){return void 0===e&&(e=!0),Object.keys(t).reduce(function(i,n){if(!i)return i=d({},t[n]);var r=0===n.indexOf("$");return e&&r?K(z(t[n]),i):!e&&r?i:i=K(i,t[n])},null)};t.use=function(t,e){if(void 0===e&&(e={}),!o(t))return r("The plugin must be a callable function");t({Validator:V,ErrorBag:y,Rules:V.rules},e)},t.mapFields=function(t){if(!t)return function(){return z(this.$validator.flags)};var e,i=(e=t,Array.isArray(e)?e.reduce(function(t,e){return~e.indexOf(".")?t[e.split(".")[1]]=e:t[e]=e,t},{}):e);return Object.keys(i).reduce(function(t,e){var n=i[e];return t[e]=function(){if(this.$validator.flags[n])return this.$validator.flags[n];if("*"===i[e])return z(this.$validator.flags,!1);if(n.indexOf(".")<=0)return{};var t=n.split("."),r=t[0],s=t.slice(1);return r=this.$validator.flags["$"+r],"*"===(s=s.join("."))&&r?z(r):r&&r[s]?r[s]:{}},t},{})},t.ErrorBag=y,t.version="2.0.3",t.default=V,Object.defineProperty(t,"__esModule",{value:!0})});